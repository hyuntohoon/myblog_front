---
/* no frontmatter needed */
const clientScript = '../src/scripts/searchBar.client.ts'
---

<style>
  /* 전체 검색바 스타일 */
  .searchbar {
    --bg: #f3f4f6;
    --bd: #d1d5db;
    --fg: #111827;
    display: grid;
    grid-template-columns: auto 1fr auto;
    align-items: center;
    gap: .5rem;
    padding: .5rem .75rem;
    border: 1px solid var(--bd);
    border-radius: 8px;
    background: var(--bg);
    color: var(--fg);
    transition: background .15s ease, border-color .15s ease, box-shadow .15s ease;
    box-shadow: 0 1px 2px rgba(0,0,0,.04);
  }

  .theme-none   { --bg:#f3f4f6; --bd:#d1d5db; --fg:#111827; }
  .theme-artist { --bg:#eef2ff; --bd:#c7d2fe; --fg:#3730a3; }
  .theme-album  { --bg:#ecfdf5; --bd:#a7f3d0; --fg:#065f46; }

  .toggle {
    border: 1px solid transparent;
    padding: .4rem .7rem;
    border-radius: 8px;
    font-size: .9rem;
    font-weight: 600;
    background: transparent;
    transition: background .15s, border-color .15s;
  }
  .toggle:hover { cursor:pointer; background: rgba(0,0,0,.05); }
  .toggle[aria-pressed="true"] { background: rgba(255,255,255,.55); border-color: rgba(0,0,0,.15); }

  .input { width:100%; border:none; background:transparent; font-size:1rem; padding:.4rem .25rem; outline:none; }

  .search-btn { border:none; background:transparent; padding:.4rem; border-radius:8px; }
  .search-btn:hover { cursor:pointer; background: rgba(0,0,0,.06); }

  /* 결과 컨테이너 */
  .results-wrap {
    margin-top:.75rem;
    border:1px solid #e5e7eb;
    border-radius:10px;
    background:#fff;
    overflow-x:auto; overflow-y:hidden;
    padding:.75rem;
  }

  /* 가로 1줄 카드 스트립 */
  .results-row {
    --card-px: 135px;              /* 🔹원하는 카드 가로폭/커버 한 변 (예: 180/200/240) */
    --card-size: 135px;   /* TS가 읽는 변수와 동기화 */
    display:grid;
    grid-auto-flow: column;
    grid-auto-columns: var(--card-px);
    gap: 1.25rem;
  }

  /* ⬇ 동적 요소에도 먹히도록 :global */
  :global(#resultsRow .card){
    width: var(--card-px) !important;
    display: grid;
    grid-template-rows: auto auto; /* 커버 + 텍스트 */
    gap: .6rem;
    border-radius: 14px;
    cursor: pointer; 
  }

  /* 정사각형 커버 래퍼 (이미지 비율 제어) */
  :global(#resultsRow .art){
   width: 100%;
  aspect-ratio: 1 / 1;
  border-radius: 14px;
  overflow: hidden;
  background: #f3f4f6;
  box-shadow: 0 2px 10px rgba(0,0,0,.06);
  border: 1px solid #e5e7eb;
  transition: box-shadow .15s ease, transform .06s ease, border-color .15s ease;
  }

  /* hover 효과는 카드 전체에 */
  :global(#resultsRow .card:hover .art){
     transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(0,0,0,.12);
  border-color: #d1d5db;
    cursor: pointer;
  }

  /* 실제 이미지: 가로 중앙 정렬 + 꽉 채우기 */
  :global(#resultsRow .thumb){
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
    object-position: center center !important; /* 🔹가로 중앙 */
    display: block;
    border-radius: 0; /* 래퍼가 둥글게 가짐 */
  }

  /* 텍스트 블록 */
  :global(#resultsRow .meta){
    display: grid;
    gap: .25rem;
    width: 100%;
  }
  :global(#resultsRow .title){
    font-size: 1.15rem;
    font-weight: 800;
    color: #111827;
    line-height: 1.2;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  :global(#resultsRow .type){
    font-size: .95rem;
    color: #6b7280;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  :global(#resultsRow .thumb),
:global(#resultsRow .meta),
:global(#resultsRow .title),
:global(#resultsRow .type){
  pointer-events: none;
}
</style>

<div id="searchbar" class="searchbar theme-none" data-mode="none">
  <div class="toggles">
    <button class="toggle" id="artistBtn" type="button" aria-pressed="false">Artist</button>
    <button class="toggle" id="albumBtn"  type="button" aria-pressed="false">Album</button>
  </div>
  <input class="input" id="q" type="search" placeholder="Select Artist or Album first" />
  <button class="search-btn" id="submitBtn" type="button">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="11" cy="11" r="7" stroke="currentColor" stroke-width="2"/></svg>
  </button>
</div>

<div class="results-wrap" id="resultsWrap" hidden>
  <div class="results-row" id="resultsRow"></div>
</div>

<script type="module" src={clientScript}></script>